do
function tempoEspera(i)
  local tempoFinal = os.time() + i
	while os.time() <= tempoFinal do end
end

function engineStartUp() -- FUNÇÃO DE INÍCIO
	screenClear = "cls" -- CLS para win32/64 e CLEAR para unix
	os.execute("chcp 1252") -- Essa linha NÃO deve existir caso o S.O seja Linux.
	version = "0.0.4a"
	title = "The knights adventure " .. version .. " - By Kamalcranio"
	SuaVida = 3000
	VidaInimigo = 3000
	SuaMana = 500
	local Rodada = 0
	inicio()
end

function inicio()
	if VidaInimigo <= 0 then
		vitoria()
	elseif SuaVida <= 0 then
		derrota()
	end
	os.execute(screenClear)
	print ("------------------------------")
	print (title)
	print ("------------------------------")
	print ("Sua vida: " .. SuaVida .. " Sua Mana: " .. SuaMana)
	print ("Vida do inimigo: " .. VidaInimigo)
	print ("------------------------------")
	print ("E a sua vez! Decida qual ataque você usara:")
	print ("e - Espada")
	print ("m - Magia")
	io.output():write("O que você vai usar? ")
	local usar = io.input():read()
	if usar == "e" then
		espada()
	elseif usar == "m" then
		magia()
	elseif usar ~= "e" then
		if usar ~= "m" then
			inicio()
	end
end
end

function espada()
	os.execute(screenClear)
	print (title)
	print ("Qual tipo de ataque voce fara?")
	print ("e - Enfiar")
	print ("c - Cortar")
	print ("v - Voltar para o inicio")
	local Espada = io.input():read()
	if Espada == "e" then
		espadaEnfia()
	elseif Espada == "c" then
		espadaCorte()
	elseif Espada == "v" then
		inicio()
	elseif Espada ~= "e" then
		if Espada ~= "c" then
			if Espada ~= "v" then
				espada()
			end
		end
	end
end

function magia()
	os.execute(screenClear)
	print (title)
	print ("Qual o tipo de magia você quer usar?")
	print ("heal - recupera ate 100HP - Custa 50MP")
	print ("gran heal - Recupera ate 300HP - Custa 150MP")
	print ("fire - Ataca com fogo - Custa 100MP")
	print ("plasma - Ataca com eletrcidade - Custa 200MP")
	print ("Digite v para voltar")
	io.output():write("Qual magia você vai usar? ")
	local Magia = io.input():read()
	if Magia == "heal" then
		if SuaMana >= 50 then
			magiaHeal()
		elseif SuaMana < 50 then
			print ("Voce nao tem mana suficiente para executar essa magia!")
			tempoEspera(3)
			inicio()
		end
	elseif Magia == "gran heal" then
		if SuaMana >= 150 then
			magiaGranHeal()
		elseif SuaMana < 150 then
			print ("Voce nao tem mana suficiente para executar essa magia!")
			tempoEspera(3)
			inicio()
		end
	elseif Magia == "fire" then
		if SuaMana >= 100 then
			magiaFire()
		elseif SuaMana < 100 then
			print ("Voce nao tem mana suficiente para executar essa magia!")
			tempoEspera(3)
			inicio()
		end
	
	elseif Magia == "plasma" then
		if SuaMana >= 200 then
			magiaPlasma()
		elseif SuaMana < 200 then
			print ("Voce nao tem mana suficiente para executar essa magia!")
			tempoEspera(3)
			inicio()
		end
	
	elseif Magia == "v" then
	inicio()
	elseif Magia ~= "heal" then
		if Magia ~= "gran heal" then
			if Magia ~= "fire" then
				if Magia ~= "plasma" then
					if Magia ~= "v" then
					 magia()
					end
				end
			end
		end
	end
end

function espadaEnfia()
	os.execute(screenClear)
	print ("Voce esta atacando!")
	tempoEspera(3)
	danoVoceInimigo = math.random(500, 750)
	VidaInimigo = VidaInimigo - danoVoceInimigo
	os.execute(screenClear)
	print ("Voce acertou o inimigo e tirou " .. danoVoceInimigo .. "HP de dano!")
	print ("Agora ele possui " .. VidaInimigo .. "HP!")
	tempoEspera(2)
	ataqueInimigo()
end

function espadaCorte()
	os.execute(screenClear)	-- Centésima linha XD
	print ("Voce esta atacando!")
	tempoEspera(3)
	danoVoceInimigo = math.random(200, 450)
	VidaInimigo = VidaInimigo - danoVoceInimigo
	os.execute(screenClear)
	print ("Voce acertou o inimigo e tirou " .. danoVoceInimigo .. "HP de dano!")
	print ("Agora ele possui " .. VidaInimigo .. "HP!")
	tempoEspera(2)
	ataqueInimigo()
end

function magiaHeal()
	os.execute(screenClear)
	print ("Voce esta fazendo a magia!")
	tempoEspera(3)
	SuaMana = SuaMana - 50
	vidaRecuperada = math.random(30, 100)
	SuaVida = SuaVida + vidaRecuperada
	os.execute(screenClear)
	print ("Voce recuperou " .. vidaRecuperada .. "HP!")
	print ("Voce possui " .. SuaVida .. "HP agora.")
	tempoEspera(2)
	ataqueInimigo()
end

function magiaGranHeal()
	os.execute(screenClear)
	print ("Voce esta fazendo a magia!")
	tempoEspera(3)	
	SuaMana = SuaMana - 150
	vidaRecuperada = math.random(50, 300)
	SuaVida = SuaVida + vidaRecuperada
	os.execute(screenClear)
	print ("Voce recuperou " .. vidaRecuperada .. "HP!")
	print ("Voce possui " .. SuaVida .. "HP agora.")
	tempoEspera(2)
	ataqueInimigo()
end

function magiaFire()
	os.execute(screenClear)
	print ("Voce esta atancando com a magia!")
	tempoEspera(3)
	SuaMana = SuaMana - 100
	danoVoceInimigo = math.random(300, 500)
	VidaInimigo = VidaInimigo - danoVoceInimigo
	os.execute(screenClear)
	print ("Voce tirou " .. danoVoceInimigo .. "HP de dano!")
	print ("Agora ele possui " .. VidaInimigo .. "HP de vida!")
	tempoEspera(2)
	ataqueInimigo()
end

function magiaPlasma()
	os.execute(screenClear)
	print ("Voce esta fazendo a magia!")
	tempoEspera(3)
	SuaMana = SuaMana - 200
	danoVoceInimigo = math.random(300, 700)
	VidaInimigo = VidaInimigo - danoVoceInimigo
	os.execute(screenClear)
	print ("Voce tirou " .. danoVoceInimigo .. "HP de dano!")
	print ("Agora ele possui " .. VidaInimigo .. "HP de vida!")
	tempoEspera(2)
	local paralisaTF = math.random(1, 4)
	if paralisaTF == 4 then
		rodadasParalisadas = 0
		print ("O inimigo está paralisado com a eletrecidade!")
		inimigoParalisado = true
	end
	tempoEspera(2)
	ataqueInimigo()
end

function ataqueInimigo()
	if VidaInimigo <= 0 then
		vitoria()
	end
	os.execute(screenClear)
	if inimigoParalisado then
		if rodadasParalisadas <= 0 then
			rodadasParalisadas = rodadasParalisadas + 1
			print ("O inimigo nao pode se mover... Esta paralisado!")
			tempoEspera(2)
			turno()
		end
	end
	local qualAtaque = math.random(1, 3)
	if qualAtaque == 3 then
		if magiaUsou == true then
			inimigoFisico()
		else
			inimigoMagia()
		end
	else
		inimigoFisico()
	end
end

function inimigoFisico()
	inimigoDano = math.random(150, 500)
	SuaVida = SuaVida - inimigoDano
	os.execute(screenClear)
	print ("Seu inimigo te atacou! Ele tirou " .. inimigoDano .. "HP de dano!")
	print ("Voce agora possui " .. SuaVida .. "HP de vida!")
	tempoEspera(2)
	turno()
end

function inimigoMagia()
	os.execute(screenClear)
	magiaInimigo = math.random(0, 2)
	if magiaInimigo == 0 then
		os.execute(screenClear)
		print ("O inimigo esta recuperando a própria vida!")
		tempoEspera(2)
		InimigoRecuperou = math.random(200, 300)
		VidaInimigo = VidaInimigo + InimigoRecuperou
		print ("O inimigo recuperou " .. InimigoRecuperou .. "HP!")
		print ("Agora ele possui " .. VidaInimigo .. "HP!")
	else
		os.execute(screenClear)
		print ("O inimigo esta fazendo uma magia!")
		tempoEspera(2)
		inimigoDano = math.random(150, 250)
		SuaVida = SuaVida - inimigoDano
		os.execute(screenClear)
		print ("O inimigo tirou " .. inimigoDano .. "HP de você!")
		print ("Você agora tem " .. SuaVida .. "HP!")
	end
tempoEspera(2)
turno()
end

function turno()
	SuaMana = SuaMana + 25
	inicio()
end

function vitoria()
	os.execute(screenClear)
	print (title)
	print ("----------------------------------")
	print ("VOCÊ VENCEU!")
	print ("Status:")
	print (SuaVida .. "HP" .. " - " .. SuaMana .. "MP")
	tempoEspera(5)
	print ("Créditos:")
	print ("Código: Kamalcranio")
	print ("Linguagem: Time LUA")
	print ("----------------------------------")
	io.input():read()
	os.exit()
end

function derrota()
	os.execute(screenClear)
	print (title)
	print ("-----------------------------------")
	print (title)
	print ("-----------------------------------")
	print ("VOCÊ PERDEU!")
	print ("Situação do inimigo: " .. VidaInimigo)
	tempoEspera(5)
	print ("Créditos:")
	print ("Código: Kamalcranio")
	print ("Linguagem: Time LUA")
	print ("-----------------------------------")
	io.input():read()
	os.exit()
end
	
engineStartUp()
end
